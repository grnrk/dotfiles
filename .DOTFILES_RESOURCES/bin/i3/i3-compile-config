#!/bin/bash

set -e

I3_CONFIG_DIR="$HOME/.config/i3"
I3_CONFIG="$I3_CONFIG_DIR/config"

CONFIGS=$(find $I3_CONFIG_DIR/ -type f,l -regextype egrep -regex "\/home\/[a-z]+\/\.config\/i3\/config\.[a-z]+")
if [ -n "$CONFIGS" ]; then
    if [ -f "$I3_CONFIG" ]; then
        cp $I3_CONFIG $I3_CONFIG.$(date +'%Y%m%d-%H%M').bak && \
        cat /dev/null > $I3_CONFIG
    fi
    for config in $CONFIGS; do
        cat $config >> $I3_CONFIG
    done
fi

